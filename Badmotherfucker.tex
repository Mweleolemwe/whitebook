import numpy as np
from scipy.integrate import quad
from scipy.special import j0

def inner(t):
    g = lambda y: y**(t-1.0) * np.arctan((2.0*y*y)/(5.0 - y*y))
    val, _ = quad(g, 0.0, 1.0, epsabs=1e-10, epsrel=1e-10, limit=300)
    return val

def outer(t):
    return - j0(np.pi*t) * inner(t)

T = 40.0
main, e1 = quad(outer, 0.0, T, epsabs=1e-10, epsrel=1e-10, limit=500)
print("I_reg (ledger, truncated) â‰ˆ", main)
